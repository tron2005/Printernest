<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Nahrávání souborů</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="p-3">

<h1>Nahrávání souborů</h1>

<input type="file" id="fileInput" multiple class="form-control mb-3" />

<button class="btn btn-primary" onclick="uploadFiles()">Nahrát vybrané soubory</button>

<progress id="uploadProgress" max="100" value="0" style="width: 100%; display: none;"></progress>

<div id="uploadStatus" class="mt-2"></div>

<script>
async function uploadFiles() {
  const input = document.getElementById("fileInput");
  if (input.files.length === 0) {
    alert("Vyberte alespoň jeden soubor.");
    return;
  }

  const progressBar = document.getElementById("uploadProgress");
  const statusDiv = document.getElementById("uploadStatus");

  const formData = new FormData();
  for (const file of input.files) {
    formData.append("file", file);
  }

  progressBar.style.display = "block";
  progressBar.value = 0;
  statusDiv.textContent = "";

  const xhr = new XMLHttpRequest();
  xhr.open("POST", "/upload/", true);

  xhr.upload.onprogress = (event) => {
    if (event.lengthComputable) {
      const percentComplete = (event.loaded / event.total) * 100;
      progressBar.value = percentComplete;
    }
  };

  xhr.onload = () => {
    if (xhr.status === 200) {
      statusDiv.textContent = "Nahrávání dokončeno.";
      progressBar.style.display = "none";
      input.value = null;
    } else {
      statusDiv.textContent = "Chyba při nahrávání: " + xhr.statusText;
    }
  };

  xhr.onerror = () => {
    statusDiv.textContent = "Chyba sítě při nahrávání.";
  };

  xhr.send(formData);
}
</script>

</body>
</html>
